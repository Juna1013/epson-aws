<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>è£½å“é¸å®šã‚¢ãƒ—ãƒª - AWS ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³æˆæœç™ºè¡¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="../assets/css/main.css" rel="stylesheet">
  </head>
  <body class="bg-gradient-to-br from-blue-50 via-cyan-50 to-blue-100 dark:bg-gray-50 text-gray-900 antialiased">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-500 via-cyan-400 to-blue-600 dark:bg-white border-b shadow-lg dark:zenn-border">
      <div class="max-w-6xl mx-auto px-4 py-3 md:py-4">
        <div class="flex items-center justify-between flex-wrap gap-4">
          <div class="flex items-center space-x-3 md:space-x-4 min-w-0">
            <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-r from-white to-blue-50 dark:bg-gradient-to-r dark:from-emerald-500 dark:to-emerald-600 rounded-lg flex items-center justify-center flex-shrink-0 shadow-sm">
              <i class="fas fa-search text-emerald-600 dark:text-white text-sm md:text-lg"></i>
            </div>
            <div class="min-w-0">
              <h1 class="text-lg md:text-xl font-semibold text-white dark:text-gray-900 truncate">è£½å“é¸å®šã‚¢ãƒ—ãƒª</h1>
              <p class="text-xs md:text-sm text-blue-100 dark:text-gray-500 truncate">AWS ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³æˆæœç™ºè¡¨ - è£½å“æ¨è–¦ãƒ‡ãƒ¢</p>
            </div>
          </div>
          <div class="flex items-center space-x-2 md:space-x-4 flex-shrink-0">
            <div class="hidden sm:flex items-center space-x-2">
              <i class="fas fa-sun text-orange-500 text-sm"></i>
              <div class="theme-toggle" onclick="toggleTheme()" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ"></div>
              <i class="fas fa-moon text-blue-400 text-sm"></i>
            </div>
            <span class="bg-gradient-to-r from-white to-blue-50 dark:bg-emerald-100 text-emerald-700 px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-medium shadow-sm">Demo</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-8 md:py-12">
      <!-- Hero Section -->
      <div class="text-center mb-8 md:mb-16">
        <h1 class="text-2xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-4">
          è£½å“é¸å®šã‚¢ãƒ—ãƒª<br class="hidden sm:block">
          <span class="epson-accent">ãƒ‡ãƒ¢</span>
        </h1>
        <p class="text-base md:text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed px-4">
          é¡§å®¢ã®æ¡ä»¶ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€AWS Lambdaã§é©åˆ‡ãªè£½å“ã‚’è‡ªå‹•é¸å®šã—ã¦ææ¡ˆã—ã¾ã™ã€‚
        </p>
      </div>

      <!-- System Flow -->
      <div class="bg-gradient-to-br from-white via-blue-50 to-cyan-50 dark:bg-white rounded-xl shadow-xl dark:zenn-shadow border border-blue-100 dark:zenn-border overflow-hidden mb-8">
        <div class="p-6">
          <h3 class="text-xl font-semibold text-gray-900 mb-6">ã‚·ã‚¹ãƒ†ãƒ ãƒ•ãƒ­ãƒ¼</h3>
          <div class="flex items-center justify-between space-x-4 overflow-x-auto">
            <div class="flex items-center space-x-3 min-w-0 flex-1">
              <div class="w-12 h-12 bg-gradient-to-br from-blue-200 to-blue-300 rounded-lg flex items-center justify-center shadow-md">
                <i class="fas fa-user text-blue-600 text-lg"></i>
              </div>
              <div class="min-w-0">
                <div class="font-medium text-gray-900">Customer</div>
                <div class="text-sm text-gray-500">æ¡ä»¶å…¥åŠ›</div>
              </div>
            </div>
            <div class="flex items-center text-gray-400 px-2">
              <i class="fas fa-arrow-right"></i>
            </div>
            <div class="flex items-center space-x-3 min-w-0 flex-1">
              <div class="w-12 h-12 bg-gradient-to-br from-orange-200 to-orange-300 rounded-lg flex items-center justify-center shadow-md">
                <i class="fas fa-bolt text-orange-600 text-lg"></i>
              </div>
              <div class="min-w-0">
                <div class="font-medium text-gray-900">Lambda</div>
                <div class="text-sm text-gray-500">è£½å“ãƒãƒƒãƒãƒ³ã‚°</div>
              </div>
            </div>
            <div class="flex items-center text-gray-400 px-2">
              <i class="fas fa-arrow-right"></i>
            </div>
            <div class="flex items-center space-x-3 min-w-0 flex-1">
              <div class="w-12 h-12 bg-gradient-to-br from-purple-200 to-purple-300 rounded-lg flex items-center justify-center shadow-md">
                <i class="fas fa-database text-purple-600 text-lg"></i>
              </div>
              <div class="min-w-0">
                <div class="font-medium text-gray-900">S3</div>
                <div class="text-sm text-gray-500">è£½å“DB</div>
              </div>
            </div>
            <div class="flex items-center text-gray-400 px-2">
              <i class="fas fa-arrow-right"></i>
            </div>
            <div class="flex items-center space-x-3 min-w-0 flex-1">
              <div class="w-12 h-12 bg-gradient-to-br from-emerald-200 to-emerald-300 rounded-lg flex items-center justify-center shadow-md">
                <i class="fas fa-gift text-emerald-600 text-lg"></i>
              </div>
              <div class="min-w-0">
                <div class="font-medium text-gray-900">Result</div>
                <div class="text-sm text-gray-500">è£½å“æ¨è–¦</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ -->
      <div class="bg-gradient-to-br from-white via-blue-50 to-cyan-50 dark:bg-white rounded-xl shadow-xl dark:zenn-shadow border border-blue-100 dark:zenn-border overflow-hidden max-w-4xl mx-auto">
        <div class="bg-gradient-to-r from-blue-500 via-cyan-400 to-emerald-500 dark:bg-gradient-to-r dark:from-emerald-500 dark:to-emerald-600 p-4">
          <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-gradient-to-r from-white to-blue-50 rounded-full flex items-center justify-center shadow-sm">
              <i class="fas fa-robot text-blue-600 text-lg"></i>
            </div>
            <div>
              <h3 class="text-white font-semibold">è£½å“é¸å®šAIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</h3>
              <p class="text-blue-100 text-sm">ã‚ãªãŸã«æœ€é©ãªè£½å“ã‚’æ¨è–¦ã—ã¾ã™</p>
            </div>
            <div class="flex-1"></div>
            <div class="flex items-center space-x-1">
              <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
              <span class="text-blue-100 text-sm">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³</span>
            </div>
          </div>
        </div>
        
        <!-- ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ -->
        <div id="chatArea" class="h-96 overflow-y-auto p-4 bg-gray-50 space-y-4">
          <!-- åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
          <div class="flex items-start space-x-3">
            <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center flex-shrink-0 shadow-md">
              <i class="fas fa-robot text-white text-sm"></i>
            </div>
            <div class="bg-white p-3 rounded-lg shadow-sm max-w-sm">
              <p class="text-gray-800">ã“ã‚“ã«ã¡ã¯ï¼è£½å“é¸å®šã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚ğŸš€</p>
              <p class="text-gray-600 text-sm mt-1">ã©ã¡ã‚‰ã®è£½å“ã‚’ãŠæ¢ã—ã§ã™ã‹ï¼Ÿ</p>
            </div>
          </div>
          
          <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
          <div class="flex justify-center">
            <div class="space-y-2">
              <button onclick="sendQuickMessage('å®¶åº­ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™')" 
                class="block bg-blue-100 hover:bg-blue-200 text-blue-800 px-4 py-2 rounded-lg text-sm transition-colors">
                ğŸ  å®¶åº­ç”¨è£½å“ã‚’æ¢ã™
              </button>
              <button onclick="sendQuickMessage('æ¥­å‹™ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™')" 
                class="block bg-purple-100 hover:bg-purple-200 text-purple-800 px-4 py-2 rounded-lg text-sm transition-colors">
                ğŸ¢ æ¥­å‹™ç”¨è£½å“ã‚’æ¢ã™
              </button>
              <button onclick="sendQuickMessage('äºˆç®—5ä¸‡å††ä»¥ä¸‹ã§ãŠé¡˜ã„ã—ã¾ã™')" 
                class="block bg-green-100 hover:bg-green-200 text-green-800 px-4 py-2 rounded-lg text-sm transition-colors">
                ğŸ’° äºˆç®—5ä¸‡å††ä»¥ä¸‹
              </button>
              <button onclick="sendQuickMessage('é«˜æ€§èƒ½ãªè£½å“ãŒå¿…è¦ã§ã™')" 
                class="block bg-orange-100 hover:bg-orange-200 text-orange-800 px-4 py-2 rounded-lg text-sm transition-colors">
                âœ¨ é«˜æ€§èƒ½è£½å“
              </button>
            </div>
          </div>
        </div>
        
        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div class="p-4 border-t border-gray-200">
          <div class="flex space-x-3">
            <input type="text" id="userInput" placeholder="è£½å“ã«ã¤ã„ã¦ä½•ã§ã‚‚ãŠèã‹ã›ãã ã•ã„..." 
              class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"
              onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()" 
              class="bg-gradient-to-r from-blue-500 to-cyan-500 dark:bg-emerald-600 hover:from-blue-600 hover:to-cyan-600 dark:hover:bg-emerald-700 text-white px-6 py-3 rounded-lg font-medium transition-all shadow-md flex items-center">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
      </div>


      <!-- ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰ -->
      <div class="mt-12 bg-gradient-to-r from-blue-50 via-cyan-50 to-blue-100 dark:bg-gradient-to-r dark:from-emerald-50 dark:to-blue-50 rounded-xl p-6 border border-blue-200 dark:border-gray-200 shadow-lg">
        <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">
          <i class="fas fa-question-circle mr-2 text-blue-600"></i>
          ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®ä½¿ã„æ–¹
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <div class="text-2xl mb-2">ğŸ’¬</div>
            <h4 class="font-semibold text-gray-900 mb-2">è‡ªç„¶ãªä¼šè©±</h4>
            <p class="text-sm text-gray-600">ã€Œå®¶åº­ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™ã€ãªã©ã€è‡ªç„¶ãªè¨€è‘‰ã§è©±ã—ã‹ã‘ã¦ãã ã•ã„</p>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <div class="text-2xl mb-2">ğŸ¯</div>
            <h4 class="font-semibold text-gray-900 mb-2">ç°¡å˜é¸æŠ</h4>
            <p class="text-sm text-gray-600">ã‚¯ã‚¤ãƒƒã‚¯ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã ã‘ã§æ¡ä»¶ã‚’é¸æŠã§ãã¾ã™</p>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <div class="text-2xl mb-2">ğŸ¤–</div>
            <h4 class="font-semibold text-gray-900 mb-2">AIæ¨è–¦</h4>
            <p class="text-sm text-gray-600">æ¡ä»¶ã«åŸºã¥ã„ã¦AIãŒæœ€é©ãªè£½å“ã‚’æ¨è–¦ã—ã¾ã™</p>
          </div>
        </div>
      </div>
    </main>

  <script>
    // æ“¬ä¼¼S3ãƒ‡ãƒ¼ã‚¿ (localStorageã«ä¿å­˜ or åˆæœŸåŒ–)
    const defaultProducts = [
      { name: "EcoClean 100", usage: "å®¶åº­ç”¨", price: 30000, feature: "åŸºæœ¬", img: "https://via.placeholder.com/200x150/10b981/ffffff?text=EcoClean+100", description: "ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å„ªã‚ŒãŸå®¶åº­ç”¨ãƒ¢ãƒ‡ãƒ«" },
      { name: "ProClean 500", usage: "æ¥­å‹™ç”¨", price: 80000, feature: "é«˜æ€§èƒ½", img: "https://via.placeholder.com/200x150/3b82f6/ffffff?text=ProClean+500", description: "æ¥­å‹™ç”¨é«˜æ€§èƒ½ãƒ¢ãƒ‡ãƒ«ã§å¤§é‡å‡¦ç†ãŒå¯èƒ½" },
      { name: "SmartWash X", usage: "å®¶åº­ç”¨", price: 60000, feature: "é«˜æ€§èƒ½", img: "https://via.placeholder.com/200x150/8b5cf6/ffffff?text=SmartWash+X", description: "ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½æ­è¼‰ã®é«˜æ€§èƒ½å®¶åº­ç”¨ãƒ¢ãƒ‡ãƒ«" },
      { name: "UltraWash Z", usage: "æ¥­å‹™ç”¨", price: 120000, feature: "é«˜æ€§èƒ½", img: "https://via.placeholder.com/200x150/f59e0b/ffffff?text=UltraWash+Z", description: "æœ€é«˜ç´šã®æ¥­å‹™ç”¨é«˜æ€§èƒ½ãƒ¢ãƒ‡ãƒ«" },
      { name: "BasicClean 50", usage: "å®¶åº­ç”¨", price: 20000, feature: "åŸºæœ¬", img: "https://via.placeholder.com/200x150/6b7280/ffffff?text=BasicClean+50", description: "ã‚·ãƒ³ãƒ—ãƒ«ã§ä½¿ã„ã‚„ã™ã„ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ¢ãƒ‡ãƒ«" },
      { name: "OfficeWash 300", usage: "æ¥­å‹™ç”¨", price: 65000, feature: "åŸºæœ¬", img: "https://via.placeholder.com/200x150/ef4444/ffffff?text=OfficeWash+300", description: "ã‚ªãƒ•ã‚£ã‚¹ã«æœ€é©ãªã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒ¢ãƒ‡ãƒ«" }
    ];

    if (!localStorage.getItem('products')) {
      localStorage.setItem('products', JSON.stringify(defaultProducts));
    }

    // ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆé–¢é€£ã®å¤‰æ•°
    let conversationState = {
      usage: null,
      budget: null,
      feature: null
    };

    // ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³
    const chatResponses = {
      'å®¶åº­ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™': {
        response: 'å®¶åº­ç”¨è£½å“ã‚’ãŠæ¢ã—ã§ã™ã­ï¼ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ äºˆç®—ã¯ã©ã®ãã‚‰ã„ã‚’ãŠè€ƒãˆã§ã—ã‚‡ã†ã‹ï¼Ÿ',
        action: () => { conversationState.usage = 'å®¶åº­ç”¨'; showBudgetOptions(); }
      },
      'æ¥­å‹™ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™': {
        response: 'æ¥­å‹™ç”¨è£½å“ã‚’ãŠæ¢ã—ã§ã™ã­ï¼ğŸ¢ äºˆç®—ã®ç¯„å›²ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚',
        action: () => { conversationState.usage = 'æ¥­å‹™ç”¨'; showBudgetOptions(); }
      },
      'äºˆç®—5ä¸‡å††ä»¥ä¸‹ã§ãŠé¡˜ã„ã—ã¾ã™': {
        response: '5ä¸‡å††ä»¥ä¸‹ã§ã™ã­ï¼ğŸ’° åŸºæœ¬æ©Ÿèƒ½ã§ååˆ†ã§ã—ã‚‡ã†ã‹ï¼Ÿãã‚Œã¨ã‚‚é«˜æ€§èƒ½ãªæ©Ÿèƒ½ãŒå¿…è¦ã§ã™ã‹ï¼Ÿ',
        action: () => { conversationState.budget = 50000; showFeatureOptions(); }
      },
      'é«˜æ€§èƒ½ãªè£½å“ãŒå¿…è¦ã§ã™': {
        response: 'é«˜æ€§èƒ½è£½å“ã‚’ã”å¸Œæœ›ã§ã™ã­ï¼âš¡ æ¡ä»¶ã‚’ç¢ºèªã—ã¦æœ€é©ãªè£½å“ã‚’æ¢ã—ã¦ã¿ã¾ã™...',
        action: () => { conversationState.feature = 'é«˜æ€§èƒ½'; processRecommendation(); }
      },
      'åŸºæœ¬æ©Ÿèƒ½ã§å¤§ä¸ˆå¤«ã§ã™': {
        response: 'åŸºæœ¬æ©Ÿèƒ½ã§ã‚ˆã‚ã—ã„ã§ã™ã­ï¼âœ¨ æ¡ä»¶ã«åˆã£ãŸè£½å“ã‚’æ¤œç´¢ã—ã¾ã™...',
        action: () => { conversationState.feature = 'åŸºæœ¬'; processRecommendation(); }
      },
      'äºˆç®—ã‚’æ•™ãˆã¦': {
        response: 'äºˆç®—ã«ã¤ã„ã¦ã§ã™ã­ğŸ’° ä»¥ä¸‹ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„',
        action: () => showBudgetOptions()
      },
      'ãŠã™ã™ã‚ã‚’æ•™ãˆã¦': {
        response: 'æœ€é©ãªè£½å“ã‚’ã”ææ¡ˆã™ã‚‹ãŸã‚ã«ã€ã¾ãšä½¿ç”¨ç”¨é€”ã‚’æ•™ãˆã¦ãã ã•ã„ğŸ”',
        action: () => showUsageOptions()
      }
    };

    function sendMessage() {
      const input = document.getElementById('userInput');
      const message = input.value.trim();
      
      if (!message) return;
      
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
      addMessage(message, 'user');
      input.value = '';
      
      // ãƒœãƒƒãƒˆã®å¿œç­”ã‚’å‡¦ç†
      setTimeout(() => {
        handleBotResponse(message);
      }, 500);
    }

    function sendQuickMessage(message) {
      addMessage(message, 'user');
      setTimeout(() => {
        handleBotResponse(message);
      }, 500);
    }

    function handleKeyPress(event) {
      if (event.key === 'Enter') {
        sendMessage();
      }
    }

    function addMessage(message, sender) {
      const chatArea = document.getElementById('chatArea');
      const messageDiv = document.createElement('div');
      
      if (sender === 'user') {
        messageDiv.className = 'flex items-start space-x-3 justify-end';
        messageDiv.innerHTML = `
          <div class="bg-emerald-500 text-white p-3 rounded-lg shadow-sm max-w-sm">
            <p>${message}</p>
          </div>
          <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center flex-shrink-0">
            <i class="fas fa-user text-white text-sm"></i>
          </div>
        `;
      } else {
        messageDiv.className = 'flex items-start space-x-3';
        messageDiv.innerHTML = `
          <div class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
            <i class="fas fa-robot text-white text-sm"></i>
          </div>
          <div class="bg-white p-3 rounded-lg shadow-sm max-w-sm">
            <p class="text-gray-800">${message}</p>
          </div>
        `;
      }
      
      chatArea.appendChild(messageDiv);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    function handleBotResponse(userMessage) {
      // ç°¡å˜ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
      let response = null;
      
      for (const [pattern, data] of Object.entries(chatResponses)) {
        if (userMessage.includes(pattern) || userMessage === pattern) {
          response = data;
          break;
        }
      }
      
      if (!response) {
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¬ã‚¹ãƒãƒ³ã‚¹
        if (userMessage.includes('äºˆç®—') || userMessage.includes('ä¾¡æ ¼') || userMessage.includes('å††')) {
          response = {
            response: 'äºˆç®—ã«ã¤ã„ã¦ãŠèã‹ã›ãã ã•ã„ğŸ’°',
            action: () => showBudgetOptions()
          };
        } else if (userMessage.includes('å®¶åº­') || userMessage.includes('ãƒ›ãƒ¼ãƒ ')) {
          response = chatResponses['å®¶åº­ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™'];
        } else if (userMessage.includes('æ¥­å‹™') || userMessage.includes('ã‚ªãƒ•ã‚£ã‚¹') || userMessage.includes('ä¼šç¤¾')) {
          response = chatResponses['æ¥­å‹™ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™'];
        } else {
          response = {
            response: 'ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€ã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸğŸ˜… ä»¥ä¸‹ã‹ã‚‰ãŠé¸ã³ãã ã•ã„',
            action: () => showUsageOptions()
          };
        }
      }
      
      addMessage(response.response, 'bot');
      if (response.action) {
        setTimeout(response.action, 1000);
      }
    }

    function showUsageOptions() {
      const chatArea = document.getElementById('chatArea');
      const optionsDiv = document.createElement('div');
      optionsDiv.className = 'flex justify-center';
      optionsDiv.innerHTML = `
        <div class="space-y-2">
          <button onclick="sendQuickMessage('å®¶åº­ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™')" 
            class="block bg-blue-100 hover:bg-blue-200 text-blue-800 px-4 py-2 rounded-lg text-sm transition-colors">
            ğŸ  å®¶åº­ç”¨è£½å“
          </button>
          <button onclick="sendQuickMessage('æ¥­å‹™ç”¨ã®è£½å“ã‚’æ¢ã—ã¦ã„ã¾ã™')" 
            class="block bg-purple-100 hover:bg-purple-200 text-purple-800 px-4 py-2 rounded-lg text-sm transition-colors">
            ğŸ¢ æ¥­å‹™ç”¨è£½å“
          </button>
        </div>
      `;
      chatArea.appendChild(optionsDiv);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    function showBudgetOptions() {
      const chatArea = document.getElementById('chatArea');
      const optionsDiv = document.createElement('div');
      optionsDiv.className = 'flex justify-center';
      optionsDiv.innerHTML = `
        <div class="space-y-2">
          <button onclick="sendQuickMessage('äºˆç®—3ä¸‡å††ä»¥ä¸‹ã§ãŠé¡˜ã„ã—ã¾ã™'); setBudget(30000)" 
            class="block bg-green-100 hover:bg-green-200 text-green-800 px-4 py-2 rounded-lg text-sm transition-colors">
            ğŸ’° 3ä¸‡å††ä»¥ä¸‹
          </button>
          <button onclick="sendQuickMessage('äºˆç®—5ä¸‡å††ä»¥ä¸‹ã§ãŠé¡˜ã„ã—ã¾ã™')" 
            class="block bg-green-100 hover:bg-green-200 text-green-800 px-4 py-2 rounded-lg text-sm transition-colors">
            ğŸ’° 5ä¸‡å††ä»¥ä¸‹
          </button>
          <button onclick="sendQuickMessage('äºˆç®—10ä¸‡å††ä»¥ä¸‹ã§ãŠé¡˜ã„ã—ã¾ã™'); setBudget(100000)" 
            class="block bg-green-100 hover:bg-green-200 text-green-800 px-4 py-2 rounded-lg text-sm transition-colors">
            ğŸ’° 10ä¸‡å††ä»¥ä¸‹
          </button>
        </div>
      `;
      chatArea.appendChild(optionsDiv);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    function showFeatureOptions() {
      const chatArea = document.getElementById('chatArea');
      const optionsDiv = document.createElement('div');
      optionsDiv.className = 'flex justify-center';
      optionsDiv.innerHTML = `
        <div class="space-y-2">
          <button onclick="sendQuickMessage('åŸºæœ¬æ©Ÿèƒ½ã§å¤§ä¸ˆå¤«ã§ã™')" 
            class="block bg-blue-100 hover:bg-blue-200 text-blue-800 px-4 py-2 rounded-lg text-sm transition-colors">
            â­ åŸºæœ¬æ©Ÿèƒ½
          </button>
          <button onclick="sendQuickMessage('é«˜æ€§èƒ½ãªè£½å“ãŒå¿…è¦ã§ã™')" 
            class="block bg-orange-100 hover:bg-orange-200 text-orange-800 px-4 py-2 rounded-lg text-sm transition-colors">
            ğŸš€ é«˜æ€§èƒ½
          </button>
        </div>
      `;
      chatArea.appendChild(optionsDiv);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    function setBudget(amount) {
      conversationState.budget = amount;
    }

    function processRecommendation() {
      if (!conversationState.usage || !conversationState.budget || !conversationState.feature) {
        addMessage('æ¡ä»¶ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚', 'bot');
        return;
      }

      setTimeout(() => {
        const products = JSON.parse(localStorage.getItem('products'));
        const candidates = products.filter(p => 
          p.usage === conversationState.usage && 
          p.feature === conversationState.feature && 
          p.price <= conversationState.budget
        );

        if (candidates.length > 0) {
          const best = candidates.sort((a,b) => a.price - b.price)[0];
          showProductRecommendation(best, candidates.length);
        } else {
          addMessage('ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ğŸ˜… æ¡ä»¶ã«åˆã†è£½å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚', 'bot');
        }
        
        // çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
        conversationState = { usage: null, budget: null, feature: null };
      }, 1500);
    }

    function showProductRecommendation(product, totalCandidates) {
      const chatArea = document.getElementById('chatArea');
      const productDiv = document.createElement('div');
      productDiv.className = 'flex items-start space-x-3';
      productDiv.innerHTML = `
        <div class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
          <i class="fas fa-robot text-white text-sm"></i>
        </div>
        <div class="bg-white p-4 rounded-lg shadow-sm max-w-md border border-emerald-200">
          <p class="text-emerald-600 font-semibold mb-3">âœ¨ ãŠã™ã™ã‚è£½å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼</p>
          <div class="border rounded-lg p-3">
            <img src="${product.img}" alt="${product.name}" class="w-full h-24 object-cover rounded mb-3">
            <h4 class="font-bold text-gray-900">${product.name}</h4>
            <p class="text-sm text-gray-600 mb-2">${product.description}</p>
            <div class="space-y-1 text-xs">
              <div>ğŸ  ${product.usage}</div>
              <div>âš¡ ${product.feature}</div>
              <div class="font-semibold text-emerald-600">ğŸ’° ${product.price.toLocaleString()}å††</div>
            </div>
          </div>
          <p class="text-xs text-gray-500 mt-2">${totalCandidates}ä»¶ã®å€™è£œã‹ã‚‰æœ€é©ãªè£½å“ã‚’é¸å®šã—ã¾ã—ãŸ</p>
        </div>
      `;
      chatArea.appendChild(productDiv);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    // ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®ãŸã‚ã€è‡ªå‹•åˆæœŸåŒ–ã¯ä¸è¦
  </script>

  <!-- Footer -->
  <footer class="bg-gradient-to-r from-blue-600 via-cyan-500 to-blue-700 dark:bg-white border-t border-blue-300 dark:border-gray-200 mt-16 shadow-xl">
    <div class="max-w-4xl mx-auto px-4 py-8">
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0">
        <!-- Left Section -->
        <div class="flex items-center space-x-4">
          <div class="w-8 h-8 bg-gradient-to-r from-white to-blue-50 dark:bg-gradient-to-r dark:from-emerald-500 dark:to-emerald-600 rounded-lg flex items-center justify-center shadow-sm">
            <i class="fas fa-search text-emerald-600 dark:text-white text-sm"></i>
          </div>
          <div>
            <h3 class="font-semibold text-white dark:text-gray-900 text-sm">è£½å“é¸å®šã‚¢ãƒ—ãƒª</h3>
            <p class="text-xs text-blue-100 dark:text-gray-500">AWS ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³æˆæœç™ºè¡¨ - è£½å“æ¨è–¦ãƒ‡ãƒ¢</p>
          </div>
        </div>
        
        <!-- Right Section -->
        <div class="text-right">
          <p class="text-sm text-gray-600 mb-1">ğŸ” è£½å“é¸å®šãƒ‡ãƒ¢</p>
          <p class="text-xs text-gray-500">Lambda ã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªè£½å“ãƒãƒƒãƒãƒ³ã‚°</p>
        </div>
      </div>
      
      <!-- Bottom Section -->
      <div class="mt-6 pt-4 border-t border-gray-100 flex flex-col md:flex-row justify-between items-center space-y-2 md:space-y-0">
        <p class="text-xs text-gray-400">Â© 2025 Seiko Epson Corporation. All rights reserved.</p>
        <div class="flex items-center space-x-4 text-xs text-gray-400">
          <span class="flex items-center">
            <i class="fas fa-code mr-1"></i>
            Built with AWS
          </span>
          <span class="flex items-center">
            <i class="fas fa-heart mr-1 text-red-400"></i>
            Made with care
          </span>
        </div>
      </div>
    </div>
  </footer>

  <script src="../assets/js/theme.js"></script>
  </body>
</html>
